/*******************************************************************************
* Leonardo Mudrek de Almeida
* UTFPR - CT
*
*
* License : MIT
*******************************************************************************/

/*******************************************************************************
* INCLUDES
*******************************************************************************/
#include "peripherals.h"
#include "log.h"
#include "timer.h"
#include "pins.h"
#include "app.h"
#include "flow.h"
#include "interrupt.h"
#include <stddef.h>
/*******************************************************************************
* DEFINES E ENUMS
*******************************************************************************/

/*******************************************************************************
* TYPEDEFS
*******************************************************************************/

/*******************************************************************************
* PROTÓTIPOS DE FUNÇÕES
*******************************************************************************/
static void startButton_handler(void);

/*******************************************************************************
* CONSTANTES
*******************************************************************************/

/*******************************************************************************
* VARIÁVEIS
*******************************************************************************/
/**
 *   \brief Tabela de interrupção para o pino de start 
 */
static interrupt_t portBInterrupt[] = {
  {
    .pin = START_BUTTON,
    .handler = startButton_handler,
  },
  {
    .pin = NULL_PIN,
    .handler = NULL,
  }
};

/*******************************************************************************
* FUNÇÕES EXPORTADAS
*******************************************************************************/
/**
 * Inicializa periféricos do sistema
 */
void peripherals_init(void) {
	io_init();
  timer_init();
	log_init();
  flow_init();
	interrupt_port_init(portBInterrupt);
}

/*******************************************************************************
* FUNÇÕES LOCAIS
*******************************************************************************/
/**
 * Handler para tratar interrupção gerada pelo botão de start
 * 
 */
static void startButton_handler(void) {
  app_set_signal(APP_SIGNAL_SW_START);
}

/*******************************************************************************
* END OF FILE
*******************************************************************************/
